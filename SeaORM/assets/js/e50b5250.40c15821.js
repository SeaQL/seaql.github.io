"use strict";(self.webpackChunksea_orm=self.webpackChunksea_orm||[]).push([[64409],{28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>s});var d=t(96540);const i={},r=d.createContext(i);function l(e){const n=d.useContext(r);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),d.createElement(r.Provider,{value:n},e.children)}},78690:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>d,toc:()=>o});const d=JSON.parse('{"id":"basic-crud/delete","title":"Delete","description":"Delete One","source":"@site/docs/05-basic-crud/07-delete.md","sourceDirName":"05-basic-crud","slug":"/basic-crud/delete","permalink":"/SeaORM/docs/basic-crud/delete","draft":false,"unlisted":false,"editUrl":"https://github.com/SeaQL/seaql.github.io/edit/master/SeaORM/docs/05-basic-crud/07-delete.md","tags":[],"version":"current","lastUpdatedBy":"Chris Tsang","lastUpdatedAt":1772368507000,"sidebarPosition":7,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Save","permalink":"/SeaORM/docs/basic-crud/save"},"next":{"title":"JSON","permalink":"/SeaORM/docs/basic-crud/json"}}');var i=t(74848),r=t(28453);const l={},s="Delete",a={},o=[{value:"Delete One",id:"delete-one",level:2},{value:"Delete by Primary Key",id:"delete-by-primary-key",level:2},{value:"Delete by Unique Key",id:"delete-by-unique-key",level:2},{value:"Delete Many",id:"delete-many",level:2},{value:"Returning Deleted Models",id:"returning-deleted-models",level:2}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"delete",children:"Delete"})}),"\n",(0,i.jsx)(n.h2,{id:"delete-one",children:"Delete One"}),"\n",(0,i.jsxs)(n.p,{children:["Find a ",(0,i.jsx)(n.code,{children:"Model"})," from the database, then delete the corresponding row from database."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:"use sea_orm::entity::ModelTrait;\n\nlet orange: Option<fruit::Model> = Fruit::find_by_id(30).one(db).await?;\nlet orange: fruit::Model = orange.unwrap();\n\nlet res: DeleteResult = orange.delete(db).await?;\nassert_eq!(res.rows_affected, 1);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"delete-by-primary-key",children:"Delete by Primary Key"}),"\n",(0,i.jsxs)(n.p,{children:["Delete a row directly by its primary key, without selecting the ",(0,i.jsx)(n.code,{children:"Model"})," first."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:"let res: DeleteResult = Fruit::delete_by_id(38).exec(db).await?;\nassert_eq!(res.rows_affected, 1);\n"})}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["Since ",(0,i.jsx)(n.code,{children:"2.0.0"})]}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"delete_by_id"})," now returns ",(0,i.jsx)(n.code,{children:"ValidatedDeleteOne"})," instead of ",(0,i.jsx)(n.code,{children:"DeleteMany"}),". Normal ",(0,i.jsx)(n.code,{children:"exec"})," usage is unchanged, but ",(0,i.jsx)(n.code,{children:"exec_with_returning"})," now returns ",(0,i.jsx)(n.code,{children:"Option<Model>"})," instead of ",(0,i.jsx)(n.code,{children:"Vec<Model>"}),"."]})]}),"\n",(0,i.jsx)(n.h2,{id:"delete-by-unique-key",children:"Delete by Unique Key"}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["Since ",(0,i.jsx)(n.code,{children:"2.0.0"})]})}),"\n",(0,i.jsxs)(n.p,{children:["If the entity has a ",(0,i.jsx)(n.code,{children:"#[sea_orm(unique)]"})," attribute, a ",(0,i.jsx)(n.code,{children:"delete_by_*"})," convenience method is generated:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:'user::Entity::delete_by_email("bob@spam.com").exec(db).await?;\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Like ",(0,i.jsx)(n.code,{children:"delete_by_id"}),", this returns ",(0,i.jsx)(n.code,{children:"ValidatedDeleteOne"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"delete-many",children:"Delete Many"}),"\n",(0,i.jsxs)(n.p,{children:["You can also delete multiple rows from the database without finding each ",(0,i.jsx)(n.code,{children:"Model"})," with SeaORM select."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:"// DELETE FROM `fruit` WHERE `fruit`.`name` LIKE '%Orange%'\nlet res: DeleteResult = fruit::Entity::delete_many()\n    .filter(fruit::Column::Name.contains(\"Orange\"))\n    .exec(db)\n    .await?;\n\nassert_eq!(res.rows_affected, 2);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"returning-deleted-models",children:"Returning Deleted Models"}),"\n",(0,i.jsxs)(n.p,{children:["Postgres and SQLite only, MariaDB requires the ",(0,i.jsx)(n.code,{children:"mariadb-use-returning"})," feature flag."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:'assert_eq!(\n    fruit::Entity::delete(ActiveModel {\n        id: Set(3),\n        ..Default::default()\n    })\n    .exec_with_returning(db)\n    .await?,\n    Some(fruit::Model {\n        id: 3,\n        name: "Apple".to_owned(),\n    })\n);\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:"let deleted_models: Vec<order::Model> = order::Entity::delete_many()\n    .filter(order::Column::CustomerId.eq(22))\n    .exec_with_returning(db)\n    .await?\n\nassert_eq!(deleted_models.len(), 2); // two items deleted\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);