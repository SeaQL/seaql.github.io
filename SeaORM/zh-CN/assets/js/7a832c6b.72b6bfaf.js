"use strict";(self.webpackChunksea_orm=self.webpackChunksea_orm||[]).push([[81101],{28453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>s});var r=t(96540);const i={},a=r.createContext(i);function d(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(a.Provider,{value:n},e.children)}},68716:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"basic-crud/update","title":"\u66f4\u65b0","description":"\u66f4\u65b0\u5355\u6761","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/05-basic-crud/05-update.md","sourceDirName":"05-basic-crud","slug":"/basic-crud/update","permalink":"/SeaORM/zh-CN/docs/basic-crud/update","draft":false,"unlisted":false,"editUrl":"https://github.com/SeaQL/seaql.github.io/edit/master/SeaORM/docs/05-basic-crud/05-update.md","tags":[],"version":"current","lastUpdatedBy":"Chris Tsang","lastUpdatedAt":1772368507000,"sidebarPosition":5,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u63d2\u5165","permalink":"/SeaORM/zh-CN/docs/basic-crud/insert"},"next":{"title":"\u4fdd\u5b58","permalink":"/SeaORM/zh-CN/docs/basic-crud/save"}}');var i=t(74848),a=t(28453);const d={},s="\u66f4\u65b0",c={},l=[{value:"\u66f4\u65b0\u5355\u6761",id:"\u66f4\u65b0\u5355\u6761",level:2},{value:"\u6279\u91cf\u66f4\u65b0",id:"\u6279\u91cf\u66f4\u65b0",level:2},{value:"\u8fd4\u56de\u66f4\u65b0\u7684\u6a21\u578b",id:"\u8fd4\u56de\u66f4\u65b0\u7684\u6a21\u578b",level:2}];function o(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u66f4\u65b0",children:"\u66f4\u65b0"})}),"\n",(0,i.jsx)(n.h2,{id:"\u66f4\u65b0\u5355\u6761",children:"\u66f4\u65b0\u5355\u6761"}),"\n",(0,i.jsxs)(n.p,{children:["\u4ece\u67e5\u8be2\u7ed3\u679c\u4e2d\u83b7\u53d6\u6a21\u578b\u540e\uff0c\u5982\u679c\u8981\u5c06\u5176\u4fdd\u5b58\u56de\u6570\u636e\u5e93\uff0c\u9700\u8981",(0,i.jsx)(n.em,{children:"\u5148"}),"\u5c06\u5176\u8f6c\u6362\u4e3a ",(0,i.jsx)(n.code,{children:"ActiveModel"}),"\u3002\u751f\u6210\u7684\u67e5\u8be2\u53ea\u4f1a\u5305\u542b ",(0,i.jsx)(n.code,{children:"Set"})," \u72b6\u6001\u7684\u5c5e\u6027\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:'let pear: Option<fruit::Model> = Fruit::find_by_id(28).one(db).await?;\n\n// Into ActiveModel\nlet mut pear: fruit::ActiveModel = pear.unwrap().into();\n\n// Update name attribute\npear.name = Set("Sweet pear".to_owned());\n\n// SQL: `UPDATE "fruit" SET "name" = \'Sweet pear\' WHERE "id" = 28`\nlet pear: fruit::Model = pear.update(db).await?;\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u8981\u66f4\u65b0\u6240\u6709\u5c5e\u6027\uff0c\u53ef\u4ee5\u5c06 ",(0,i.jsx)(n.code,{children:"Unchanged"})," \u8f6c\u6362\u4e3a ",(0,i.jsx)(n.code,{children:"Set"}),"\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:'// Into ActiveModel\nlet mut pear: fruit::ActiveModel = pear.into();\n\n// Update name attribute\npear.name = Set("Sweet pear".to_owned());\n\n// Set a specific attribute as "dirty" (force update)\npear.reset(fruit::Column::CakeId);\n// Or, set all attributes as "dirty" (force update)\npear.reset_all();\n\n// SQL: `UPDATE "fruit" SET "name" = \'Sweet pear\', "cake_id" = 10 WHERE "id" = 28`\nlet pear: fruit::Model = pear.update(db).await?;\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u6279\u91cf\u66f4\u65b0",children:"\u6279\u91cf\u66f4\u65b0"}),"\n",(0,i.jsx)(n.p,{children:"\u4e5f\u53ef\u4ee5\u5728\u4e0d\u67e5\u627e\u6bcf\u4e2a\u6a21\u578b\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 SeaORM select \u6279\u91cf\u66f4\u65b0\u6570\u636e\u5e93\u4e2d\u7684\u591a\u884c\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:"// Bulk set attributes using ActiveModel\nlet update_result: UpdateResult = Fruit::update_many()\n    .set(pear)\n    .filter(fruit::Column::Id.is_in(vec![1]))\n    .exec(db)\n    .await?;\n\n// UPDATE `fruit` SET `cake_id` = 1 WHERE `fruit`.`name` LIKE '%Apple%'\nFruit::update_many()\n    .col_expr(fruit::Column::CakeId, Expr::value(1))\n    .filter(fruit::Column::Name.contains(\"Apple\"))\n    .exec(db)\n    .await?;\n"})}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["Since ",(0,i.jsx)(n.code,{children:"2.0.0"})]}),(0,i.jsxs)(n.p,{children:["\u65b0\u589e ",(0,i.jsx)(n.code,{children:"ColumnTrait::eq_any"})," \u4f5c\u4e3a ",(0,i.jsx)(n.code,{children:"= ANY"})," \u8fd0\u7b97\u7b26\u7684\u7b80\u5199\u3002\u4ec5 Postgres \u652f\u6301\u3002"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:"Fruit::update_many().filter(fruit::Column::Id.eq_any(vec![2, 3]))\n"})})]}),"\n",(0,i.jsx)(n.h2,{id:"\u8fd4\u56de\u66f4\u65b0\u7684\u6a21\u578b",children:"\u8fd4\u56de\u66f4\u65b0\u7684\u6a21\u578b"}),"\n",(0,i.jsxs)(n.p,{children:["\u4ec5 Postgres \u548c SQLite \u652f\u6301\uff0cMariaDB \u9700\u8981 ",(0,i.jsx)(n.code,{children:"mariadb-use-returning"})," feature \u6807\u5fd7\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:'let fruits: Vec<fruit::Model> = Fruit::update_many()\n    .col_expr(fruit::Column::CakeId, Expr::value(1))\n    .filter(fruit::Column::Name.contains("Apple"))\n    .exec_with_returning(db)\n    .await?;\n\nassert_eq!(\n    fruits[0],\n    fruit::Model {\n        id: 2,\n        name: "Apple".to_owned(),\n        cake_id: Some(1),\n    }\n);\n'})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);