"use strict";(self.webpackChunksea_orm=self.webpackChunksea_orm||[]).push([[20054],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>d});var i=t(96540);const r={},l=i.createContext(r);function o(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(l.Provider,{value:n},e.children)}},86297:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>s});const i=JSON.parse('{"id":"relation/multi-selects","title":"\u591a\u8868\u67e5\u8be2","description":"\u5728\u4e0a\u4e00\u7ae0\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 \u5c40\u90e8\u6a21\u578b\u6765\u4e00\u8d77\u67e5\u8be2\u591a\u4e2a Entity\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 multi-select API \u5b9e\u73b0\u76f8\u540c\u7684\u6548\u679c\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/06-relation/10-multi-selects.md","sourceDirName":"06-relation","slug":"/relation/multi-selects","permalink":"/SeaORM/zh-CN/docs/relation/multi-selects","draft":false,"unlisted":false,"editUrl":"https://github.com/SeaQL/seaql.github.io/edit/master/SeaORM/docs/06-relation/10-multi-selects.md","tags":[],"version":"current","lastUpdatedBy":"Chris Tsang","lastUpdatedAt":1772389428000,"sidebarPosition":10,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u5d4c\u5957\u67e5\u8be2","permalink":"/SeaORM/zh-CN/docs/relation/nested-selects"},"next":{"title":"\u5173\u8054\u67e5\u8be2","permalink":"/SeaORM/zh-CN/docs/relation/relational-query"}}');var r=t(74848),l=t(28453);const o={},d="\u591a\u8868\u67e5\u8be2",a={},s=[{value:"\u67e5\u8be2\u4e09\u4e2a\u6a21\u578b",id:"\u67e5\u8be2\u4e09\u4e2a\u6a21\u578b",level:2},{value:"\u6574\u5408\u7ed3\u679c",id:"\u6574\u5408\u7ed3\u679c",level:3},{value:"\u94fe\u5f0f",id:"\u94fe\u5f0f",level:4},{value:"\u661f\u578b",id:"\u661f\u578b",level:4},{value:"\u67e5\u8be2\u6700\u591a\u516d\u4e2a\u6a21\u578b",id:"\u67e5\u8be2\u6700\u591a\u516d\u4e2a\u6a21\u578b",level:2}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"\u591a\u8868\u67e5\u8be2",children:"\u591a\u8868\u67e5\u8be2"})}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u4e0a\u4e00\u7ae0\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 \u5c40\u90e8\u6a21\u578b\u6765\u4e00\u8d77\u67e5\u8be2\u591a\u4e2a Entity\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 multi-select API \u5b9e\u73b0\u76f8\u540c\u7684\u6548\u679c\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u67e5\u8be2\u4e09\u4e2a\u6a21\u578b",children:"\u67e5\u8be2\u4e09\u4e2a\u6a21\u578b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"Order -> LineItem -> Cake\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"let items: Vec<(order::Model, Option<lineitem::Model>, Option<cake::Model>)> =\n    order::Entity::find()\n        .find_also_related(lineitem::Entity)\n        .and_also_related(cake::Entity)\n        .all(db)\n        .await?;\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"find_also_related"})," \u57fa\u4e8e\u7b2c\u4e00\u4e2a Entity \u7684\u5173\u7cfb\u3002\n",(0,r.jsx)(n.code,{children:"and_also_related"})," \u57fa\u4e8e\u7b2c\u4e8c\u4e2a Entity \u7684\u5173\u7cfb\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u8981\u4f7f\u7528\u4e0d\u540c\u7684 join \u62d3\u6251\uff0c\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"Order -> Customer\n      -> LineItem\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"order::Entity::find()\n    .find_also_related(customer::Entity)\n    .find_also_related(lineitem::Entity)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u6574\u5408\u7ed3\u679c",children:"\u6574\u5408\u7ed3\u679c"}),"\n",(0,r.jsx)(n.p,{children:"\u4f60\u53ef\u4ee5\u5728\u4e09\u4e2a\u6a21\u578b\u9009\u62e9\u4e0a\u5408\u5e76\u67e5\u8be2\u7ed3\u679c\u3002\u8f93\u51fa\u5f62\u72b6\u53d6\u51b3\u4e8e join \u7684\u62d3\u6251\u7ed3\u6784\u3002"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.mdxAdmonitionTitle,{children:["\u81ea ",(0,r.jsx)(n.code,{children:"2.0.0"})," \u8d77"]})}),"\n",(0,r.jsx)(n.h4,{id:"\u94fe\u5f0f",children:"\u94fe\u5f0f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"Order -> LineItem -> Cake\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"let items: Vec<(order::Model, Option<lineitem::Model>, Option<cake::Model>)> =\n    order::Entity::find()\n        .find_also_related(lineitem::Entity)\n        .and_also_related(cake::Entity)\n        .order_by_asc(order::Column::Id)\n        .order_by_asc(lineitem::Column::Id)\n        .all(&ctx.db)\n        .await?;\n\n// flat result\nassert_eq!(\n    items,\n    vec![\n        (order, Some(line_1), Some(cake_1)),\n        (order, Some(line_2), Some(cake_2)),\n    ]\n);\n\nlet items: Vec<(order::Model, Vec<(lineitem::Model, Vec<cake::Model>)>)> =\n    order::Entity::find()\n        .find_also_related(lineitem::Entity)\n        .and_also_related(cake::Entity)\n        .order_by_asc(order::Column::Id)\n        .order_by_asc(lineitem::Column::Id)\n        .consolidate() // <-\n        .all(&ctx.db)\n        .await?;\n\n// consolidated by order first, then by line\nassert_eq!(\n    items,\n    vec![(\n        order,\n        vec![(line_1, vec![cake_1]), (line_2, vec![cake_2])]\n    )]\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5b83\u53ef\u4ee5\u5305\u542b\u4e24\u4e2a\u4e00\u5bf9\u591a\u5173\u7cfb\u3002\u4f8b\u5982\uff0c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"vec![\n    (bakery, Some(baker_1), Some(cake_1)),\n    (bakery, Some(baker_1), Some(cake_2)),\n    (bakery, Some(baker_2), Some(cake_3)),\n]\n// would be consolidated into:\nvec![(\n    bakery,\n    vec![\n        (baker_1, vec![cake_1, cake_2]),\n        (baker_2, vec![cake_3]),\n    ]\n)]\n"})}),"\n",(0,r.jsx)(n.h4,{id:"\u661f\u578b",children:"\u661f\u578b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"Order -> Customer\n      -> LineItem\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"let items: Vec<(order::Model, Option<customer::Model>, Option<lineitem::Model>)> =\n    order::Entity::find()\n        .find_also_related(customer::Entity)\n        .find_also_related(lineitem::Entity)\n        .order_by_asc(order::Column::Id)\n        .order_by_asc(lineitem::Column::Id)\n        .all(&ctx.db)\n        .await?;\n\n// flat result\nassert_eq!(\n    items,\n    vec![\n        (order, Some(customer), Some(line_1)),\n        (order, Some(customer), Some(line_2)),\n    ]\n);\n\nlet items: Vec<(order::Model, Vec<customer::Model>, Vec<lineitem::Model>)> =\n    order::Entity::find()\n        .find_also_related(customer::Entity)\n        .find_also_related(lineitem::Entity)\n        .order_by_asc(order::Column::Id)\n        .order_by_asc(lineitem::Column::Id)\n        .consolidate() // <-\n        .all(&ctx.db)\n        .await?;\n\n// consolidated by order\nassert_eq!(\n    items,\n    vec![(\n        order,\n        vec![customer],\n        vec![line_1, line_2]\n    )]\n);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u67e5\u8be2\u6700\u591a\u516d\u4e2a\u6a21\u578b",children:"\u67e5\u8be2\u6700\u591a\u516d\u4e2a\u6a21\u578b"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.mdxAdmonitionTitle,{children:["\u81ea ",(0,r.jsx)(n.code,{children:"2.0.0"})," \u8d77"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// join paths:\n// one -> two -> three -> four -> five\n// one -> six\nlet (one, two, three, four, five, six) = one::Entity::find()\n    //         from entity -> to entity\n    .find_also(one::Entity,   two::Entity)   // same as .find_also_related(two::Entity)\n    .find_also(two::Entity,   three::Entity) // same as .and_also_related(three::Entity)\n    .find_also(three::Entity, four::Entity)\n    .find_also(four::Entity,  five::Entity)\n    .find_also(one::Entity,   six::Entity)\n    .one(db)\n    .await?\n    .unwrap();\n"})})]})}function m(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);