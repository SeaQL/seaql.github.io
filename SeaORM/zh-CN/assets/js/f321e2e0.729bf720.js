"use strict";(self.webpackChunksea_orm=self.webpackChunksea_orm||[]).push([[25867],{28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>l});var a=r(96540);const t={},i=a.createContext(t);function s(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),a.createElement(i.Provider,{value:n},e.children)}},49812:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"generate-entity/enumeration","title":"ActiveEnum","description":"\u4f60\u53ef\u4ee5\u5728\u6a21\u578b\u4e2d\u4f7f\u7528 Rust \u679a\u4e3e\uff0c\u5176\u503c\u6620\u5c04\u5230\u6570\u636e\u5e93\u5b57\u7b26\u4e32\u3001\u6574\u6570\u6216\u539f\u751f\u679a\u4e3e\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/04-generate-entity/04-enumeration.md","sourceDirName":"04-generate-entity","slug":"/generate-entity/enumeration","permalink":"/SeaORM/zh-CN/docs/generate-entity/enumeration","draft":false,"unlisted":false,"editUrl":"https://github.com/SeaQL/seaql.github.io/edit/master/SeaORM/docs/04-generate-entity/04-enumeration.md","tags":[],"version":"current","lastUpdatedBy":"Chris Tsang","lastUpdatedAt":1772389428000,"sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u5217\u7c7b\u578b","permalink":"/SeaORM/zh-CN/docs/generate-entity/column-types"},"next":{"title":"\u65b0\u7c7b\u578b","permalink":"/SeaORM/zh-CN/docs/generate-entity/newtype"}}');var t=r(74848),i=r(28453);const s={},l="ActiveEnum",c={},o=[{value:"\u5b57\u7b26\u4e32",id:"\u5b57\u7b26\u4e32",level:2},{value:"\u7b80\u5355\u679a\u4e3e\u5b57\u7b26\u4e32",id:"\u7b80\u5355\u679a\u4e3e\u5b57\u7b26\u4e32",level:3},{value:"\u6574\u6570",id:"\u6574\u6570",level:2},{value:"\u539f\u751f\u6570\u636e\u5e93\u679a\u4e3e",id:"\u539f\u751f\u6570\u636e\u5e93\u679a\u4e3e",level:2},{value:"MySQL",id:"mysql",level:3},{value:"Postgres",id:"postgres",level:3},{value:"1. <code>CREATE TYPE</code> \u8bed\u53e5",id:"1-create-type-\u8bed\u53e5",level:4},{value:"2. <code>create_enum_from_active_enum</code>",id:"2-create_enum_from_active_enum",level:4},{value:"SQLite",id:"sqlite",level:3},{value:"<code>ActiveEnum</code> \u7279\u5f81",id:"activeenum-\u7279\u5f81",level:2},{value:"\u5728\u6a21\u578b\u4e2d\u4f7f\u7528 ActiveEnum",id:"\u5728\u6a21\u578b\u4e2d\u4f7f\u7528-activeenum",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"activeenum",children:"ActiveEnum"})}),"\n",(0,t.jsx)(n.p,{children:"\u4f60\u53ef\u4ee5\u5728\u6a21\u578b\u4e2d\u4f7f\u7528 Rust \u679a\u4e3e\uff0c\u5176\u503c\u6620\u5c04\u5230\u6570\u636e\u5e93\u5b57\u7b26\u4e32\u3001\u6574\u6570\u6216\u539f\u751f\u679a\u4e3e\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u5b57\u7b26\u4e32",children:"\u5b57\u7b26\u4e32"}),"\n",(0,t.jsxs)(n.p,{children:["\u5bf9\u4e8e\u5b57\u7b26\u4e32\u679a\u4e3e\uff0c\u9664\u4e86\u80fd\u591f\u4e3a\u6bcf\u4e2a\u6210\u5458\u6307\u5b9a\u5b57\u7b26\u4e32\u503c\u5916\uff0c\u4f60\u8fd8\u53ef\u4ee5\u5728\u679a\u4e3e\u4e0a\u6307\u5b9a ",(0,t.jsx)(n.code,{children:"rename_all"})," \u5c5e\u6027\uff0c\u4ee5\u4fbf\u6240\u6709\u503c\u90fd\u57fa\u4e8e\u5927\u5c0f\u5199\u8f6c\u6362\u5177\u6709\u5b57\u7b26\u4e32\u503c\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'#[derive(EnumIter, DeriveActiveEnum)]\n#[sea_orm(rs_type = "String", db_type = "String(StringLen::None)", rename_all = "camelCase")]\npub enum Category {\n    BigTask,\n    SmallWork,\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u4e0a\u8ff0\u7b49\u4ef7\u4e8e\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'#[derive(EnumIter, DeriveActiveEnum)]\n#[sea_orm(rs_type = "String", db_type = "String(StringLen::None)")]\npub enum Category {\n    #[sea_orm(string_value = "bigTask")]\n    BigTask,\n    #[sea_orm(string_value = "smallBreak")]\n    SmallWork,\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u540e\u8005\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"string_value"})," \u624b\u52a8\u6307\u5b9a\u5b57\u7b26\u4e32\u503c\u3002"]}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsxs)("summary",{children:["\u4f60\u53ef\u4ee5\u5728\u6b64\u5904\u627e\u5230 ",(0,t.jsx)(n.code,{children:"rename_all"})," \u5c5e\u6027\u7684\u6709\u6548\u503c\u5217\u8868\uff1a"]}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"camelCase"}),"\n",(0,t.jsx)(n.li,{children:"kebab-case"}),"\n",(0,t.jsx)(n.li,{children:"mixed_case"}),"\n",(0,t.jsx)(n.li,{children:"SCREAMING_SNAKE_CASE"}),"\n",(0,t.jsx)(n.li,{children:"snake_case"}),"\n",(0,t.jsx)(n.li,{children:"title_case"}),"\n",(0,t.jsx)(n.li,{children:"UPPERCASE"}),"\n",(0,t.jsx)(n.li,{children:"lowercase"}),"\n",(0,t.jsx)(n.li,{children:"SCREAMING-KEBAB-CASE"}),"\n",(0,t.jsx)(n.li,{children:"PascalCase"}),"\n"]})]}),"\n",(0,t.jsx)(n.h3,{id:"\u7b80\u5355\u679a\u4e3e\u5b57\u7b26\u4e32",children:"\u7b80\u5355\u679a\u4e3e\u5b57\u7b26\u4e32"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"DeriveValueType"})," \u4e3a\u679a\u4e3e\u6dfb\u52a0\u4e86\u652f\u6301\u3002\u5b83\u4e3a\u7531\u5b57\u7b26\u4e32\u6570\u636e\u5e93\u7c7b\u578b\u652f\u6301\u7684\u5ba2\u6237\u7aef\u679a\u4e3e\u63d0\u4f9b\u4e86\u6bd4 ",(0,t.jsx)(n.code,{children:"DeriveActiveEnum"})," \u66f4\u7b80\u5355\u7684\u66ff\u4ee3\u65b9\u6848\u3002\n\u4f60\u9700\u8981\u63d0\u4f9b\u81ea\u5b9a\u4e49\u7684 ",(0,t.jsx)(n.code,{children:"from_str"})," \u548c ",(0,t.jsx)(n.code,{children:"to_str"})," \u5b9e\u73b0\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'#[derive(DeriveValueType)]\n#[sea_orm(value_type = "String")]\npub enum Category {\n    BigTask,\n    SmallWork,\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u66f4\u591a\u8be6\u60c5\u8bf7\u53c2\u9605\u4e0b\u4e00\u7ae0\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u6574\u6570",children:"\u6574\u6570"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'#[derive(EnumIter, DeriveActiveEnum)]\n#[sea_orm(rs_type = "i32", db_type = "Integer")]\npub enum Color {\n    #[sea_orm(num_value = 0)]\n    Black,\n    #[sea_orm(num_value = 1)]\n    White,\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u6216\u8005\uff0c\u4f60\u4e5f\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'#[derive(EnumIter, DeriveActiveEnum)]\n#[sea_orm(rs_type = "i32", db_type = "Integer")]\npub enum Color {\n    Black = 0,\n    White = 1,\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u539f\u751f\u6570\u636e\u5e93\u679a\u4e3e",children:"\u539f\u751f\u6570\u636e\u5e93\u679a\u4e3e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'#[derive(EnumIter, DeriveActiveEnum)]\n#[sea_orm(rs_type = "String", db_type = "Enum", enum_name = "tea")]\npub enum Tea {\n    #[sea_orm(string_value = "EverydayTea")]\n    EverydayTea,\n    #[sea_orm(string_value = "BreakfastTea")]\n    BreakfastTea,\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"mysql",children:"MySQL"}),"\n",(0,t.jsx)(n.p,{children:"MySQL \u7684\u679a\u4e3e\u53ea\u662f\u5217\u5b9a\u4e49\u7684\u4e00\u90e8\u5206\uff0c\u4e0d\u80fd\u4e3a\u4e0d\u540c\u7684\u8868\u590d\u7528\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'Table::create()\n    .table("table_name")\n    .col(ColumnDef::new("column_name")\n            .enumeration("tea", ["EverydayTea", "BreakfastTea"]))\n\n"CREATE TABLE `table_name` (`column_name` ENUM(\'EverydayTea\', \'BreakfastTea\'))",\n'})}),"\n",(0,t.jsx)(n.h3,{id:"postgres",children:"Postgres"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'Table::create()\n    .table("table_name")\n    .col(ColumnDef::new("column_name").custom("tea"))\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u4f7f\u7528 Postgres\uff0c\u679a\u4e3e\u5fc5\u987b\u5728",(0,t.jsx)(n.em,{children:"\u5b9a\u4e49\u8868\u4e4b\u524d"}),"\u5728\u5355\u72ec\u7684 ",(0,t.jsx)(n.code,{children:"Type"})," \u8bed\u53e5\u4e2d\u521b\u5efa\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a"]}),"\n",(0,t.jsxs)(n.h4,{id:"1-create-type-\u8bed\u53e5",children:["1. ",(0,t.jsx)(n.code,{children:"CREATE TYPE"})," \u8bed\u53e5"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://github.com/SeaQL/sea-orm/blob/master/sea-orm-migration/tests/common/migration/m20220118_000004_create_tea_enum.rs",children:"\u5b8c\u6574\u793a\u4f8b"}),"\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'manager\n    .create_type(\n        // CREATE TYPE "tea" AS ENUM (\'EverydayTea\', \'BreakfastTea\')\n        Type::create()\n            .as_enum("tea")\n            .values(["EverydayTea", "BreakfastTea"])\n            .to_owned(),\n    )\n    .await?;\n'})}),"\n",(0,t.jsxs)(n.h4,{id:"2-create_enum_from_active_enum",children:["2. ",(0,t.jsx)(n.code,{children:"create_enum_from_active_enum"})]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\u5b9a\u4e49 ",(0,t.jsx)(n.code,{children:"ActiveEnum"})]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'#[derive(EnumIter, DeriveActiveEnum)]\n#[sea_orm(rs_type = "String", db_type = "Enum", enum_name = "tea")]\npub enum Tea {\n    #[sea_orm(string_value = "EverydayTea")]\n    EverydayTea,\n    #[sea_orm(string_value = "BreakfastTea")]\n    BreakfastTea,\n}\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:["\u751f\u6210 ",(0,t.jsx)(n.code,{children:"CREATE TYPE"})," \u8bed\u53e5"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:"use sea_orm::{Schema, DbBackend};\n\nlet schema = Schema::new(DbBackend::Postgres);\n\nmanager\n    .create_type(\n        // CREATE TYPE \"tea\" AS ENUM ('EverydayTea', 'BreakfastTea')\n        schema.create_enum_from_active_enum::<Tea>().expect(\"Postgres only\"),\n    )\n    .await?;\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u53e6\u8bf7\u53c2\u9605 ",(0,t.jsx)(n.a,{href:"https://www.sea-ql.org/SeaORM/docs/migration/writing-migration/#schema-creation-methods",children:"Schema Creation Methods"}),"\u3002"]}),"\n",(0,t.jsx)(n.h3,{id:"sqlite",children:"SQLite"}),"\n",(0,t.jsx)(n.p,{children:"\u5728 SQLite \u4e0a\uff0c\u679a\u4e3e\u5c06\u6620\u5c04\u4e3a\u5b57\u7b26\u4e32\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"activeenum-\u7279\u5f81",children:[(0,t.jsx)(n.code,{children:"ActiveEnum"})," \u7279\u5f81"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://docs.rs/sea-orm/2.0.0-rc.25/sea_orm/derive.DeriveActiveEnum.html",children:(0,t.jsx)(n.code,{children:"DeriveActiveEnum"})})," \u5b8f\u5728\u5e95\u5c42\u5b9e\u73b0\u4e86 ",(0,t.jsx)(n.a,{href:"https://docs.rs/sea-orm/2.0.0-rc.25/sea_orm/entity/trait.ActiveEnum.html",children:(0,t.jsx)(n.code,{children:"ActiveEnum"})})," \u7279\u5f81\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'use sea_orm::entity::prelude::*;\n\n#[derive(Debug, PartialEq, Eq, EnumIter, DeriveActiveEnum)]\n#[sea_orm(\n    rs_type = "String",\n    db_type = "String(StringLen::N(1))",\n    enum_name = "category"\n)]\npub enum Category {\n    #[sea_orm(string_value = "B")]\n    Big,\n    #[sea_orm(string_value = "S")]\n    Small,\n}\n'})}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:"\u4e3a\u4fbf\u4e8e\u8bf4\u660e\uff0c\u4ee5\u4e0b\u662f\u5b8f\u5927\u81f4\u5b9e\u73b0\u7684\u5185\u5bb9\uff1a"}),(0,t.jsx)("div",{children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'use sea_orm::entity::prelude::*;\n\n#[derive(Debug, PartialEq, Eq, EnumIter)]\npub enum Category {\n    Big,\n    Small,\n}\n\n// Implementing manually\nimpl ActiveEnum for Category {\n    // The macro attribute `rs_type` is being pasted here\n    type Value = String;\n\n    // By default, the name of Rust enum in camel case if `enum_name` was not provided explicitly\n    fn name() -> String {\n        "category".to_owned()\n    }\n\n    // Map Rust enum variants to corresponding `num_value` or `string_value`\n    fn to_value(&self) -> Self::Value {\n        match self {\n            Self::Big => "B",\n            Self::Small => "S",\n        }\n        .to_owned()\n    }\n\n    // Map `num_value` or `string_value` to corresponding Rust enum variants\n    fn try_from_value(v: &Self::Value) -> Result<Self, DbErr> {\n        match v.as_ref() {\n            "B" => Ok(Self::Big),\n            "S" => Ok(Self::Small),\n            _ => Err(DbErr::Type(format!(\n                "unexpected value for Category enum: {}",\n                v\n            ))),\n        }\n    }\n\n    // The macro attribute `db_type` is being pasted here\n    fn db_type() -> ColumnDef {\n        ColumnType::String(Some(1)).def()\n    }\n}\n'})})})]}),"\n",(0,t.jsx)(n.h2,{id:"\u5728\u6a21\u578b\u4e2d\u4f7f\u7528-activeenum",children:"\u5728\u6a21\u578b\u4e2d\u4f7f\u7528 ActiveEnum"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'use sea_orm::entity::prelude::*;\n\n#[derive(Debug, Clone, PartialEq, Eq, EnumIter, DeriveActiveEnum)]\n#[sea_orm(rs_type = "String", db_type = "String(StringLen::N(1))")]\npub enum Category {\n    #[sea_orm(string_value = "B")]\n    Big,\n    #[sea_orm(string_value = "S")]\n    Small,\n}\n\n#[sea_orm::model]\n#[derive(Clone, Debug, PartialEq, Eq, DeriveEntityModel)]\n#[sea_orm(table_name = "active_enum")]\npub struct Model {\n    #[sea_orm(primary_key)]\n    pub id: i32,\n    pub category: Category,\n    pub category_opt: Option<Category>,\n}\n\nimpl ActiveModelBehavior for ActiveModel {}\n'})}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:"\u5728 SeaORM 1.0 \u4e2d\uff0c\u5373\u4f7f\u4e3a\u7a7a\u4e5f\u9700\u8981 Relation \u679a\u4e3e\uff1a"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'#[derive(Clone, Debug, PartialEq, Eq, DeriveEntityModel)]\n#[sea_orm(table_name = "active_enum")]\npub struct Model {\n    #[sea_orm(primary_key)]\n    pub id: i32,\n    pub category: Category,\n    pub category_opt: Option<Category>,\n}\n\n#[derive(Copy, Clone, Debug, EnumIter, DeriveRelation)]\npub enum Relation {}\n\nimpl ActiveModelBehavior for ActiveModel {}\n'})})]})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);