"use strict";(self.webpackChunkseaography=self.webpackChunkseaography||[]).push([[439],{4073:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>l,frontMatter:()=>o,metadata:()=>r,toc:()=>s});const r=JSON.parse('{"id":"extending-code","title":"Extending generated code","description":"When we are done generating the code we can then modify the Rust code based on our needs.","source":"@site/versioned_docs/version-0.3.0/04-extending-code.md","sourceDirName":".","slug":"/extending-code","permalink":"/preview/pr-150/Seaography/docs/extending-code","draft":false,"unlisted":false,"editUrl":"https://github.com/SeaQL/seaql.github.io/edit/master/Seaography/versioned_docs/version-0.3.0/04-extending-code.md","tags":[],"version":"0.3.0","lastUpdatedBy":"Chris Tsang","lastUpdatedAt":1755440363000,"sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Generated project structure","permalink":"/preview/pr-150/Seaography/docs/generated-project-structure"},"next":{"title":"Macros documentation","permalink":"/preview/pr-150/Seaography/docs/macros-documentation"}}');var i=t(8790),d=t(8032);const o={},c="Extending generated code",a={},s=[{value:"Introduction",id:"introduction",level:2},{value:"Major features",id:"major-features",level:2},{value:"Field guards",id:"field-guards",level:3},{value:"Query complexity and depth",id:"query-complexity-and-depth",level:3},{value:"Query depth limit",id:"query-depth-limit",level:4},{value:"Query depth limit",id:"query-depth-limit-1",level:4},{value:"More documentation",id:"more-documentation",level:4}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"extending-generated-code",children:"Extending generated code"})}),"\n",(0,i.jsx)(n.p,{children:"When we are done generating the code we can then modify the Rust code based on our needs."}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"In order to extend the existing code first you need to be comfortable with the libraries the generated code depends on."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/async-graphql/async-graphql",children:"async_graphql"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/SeaQL/sea-orm",children:"sea_orm"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/poem-web/poem",children:"poem"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Studying the generated code structure provides valuable information on where to find important features, for more info ",(0,i.jsx)(n.a,{href:"/docs/generated-project-structure",children:"here"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"When you are comfortable enough with all the terms, you can jump into the folders and add new features or logic based on your objectives."}),"\n",(0,i.jsx)(n.h2,{id:"major-features",children:"Major features"}),"\n",(0,i.jsx)(n.p,{children:"Bellow there are some important features you might need:"}),"\n",(0,i.jsx)(n.h3,{id:"field-guards",children:"Field guards"}),"\n",(0,i.jsx)(n.p,{children:"With field guards you can protect specific queries or fields accessors from being accessed using custom guard function."}),"\n",(0,i.jsxs)(n.p,{children:["You can read more here ",(0,i.jsx)(n.a,{href:"https://async-graphql.github.io/async-graphql/en/field_guard.html",children:"https://async-graphql.github.io/async-graphql/en/field_guard.html"})]}),"\n",(0,i.jsx)(n.h3,{id:"query-complexity-and-depth",children:"Query complexity and depth"}),"\n",(0,i.jsx)(n.p,{children:"The current generators doesn't prevent cyclic dependencies. A bad actor can use cyclic dependencies to perform unlimited nested queries and crash the server."}),"\n",(0,i.jsx)(n.p,{children:"We have the following entities:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:"\npub struct Category {\n    pub id: i32,\n    pub name: String,\n    pub products: Vec<Product>\n}\n\npub struct Product {\n    pub id: i32,\n    pub name: String,\n    pub categories: Vec<Category>\n}\n\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can perform the following query"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"{\n    category {\n        nodes {\n            id,\n            name,\n            product {\n                id,\n                name,\n                category {\n                    id,\n                    name,\n                    product {\n                        id,\n                        name,\n                        category {\n                            [....]\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"To prevent this behavior we can enable with few lines of code query complexity calculator and depth limiter."}),"\n",(0,i.jsx)(n.h4,{id:"query-depth-limit",children:"Query depth limit"}),"\n",(0,i.jsx)(n.p,{children:"On .env change the line from this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# DEPTH_LIMIT=\n"})}),"\n",(0,i.jsx)(n.p,{children:"to this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"DEPTH_LIMIT=2 # depth limit number\n"})}),"\n",(0,i.jsx)(n.h4,{id:"query-depth-limit-1",children:"Query depth limit"}),"\n",(0,i.jsx)(n.p,{children:"On .env change the line from this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# COMPLEXITY_LIMIT=\n"})}),"\n",(0,i.jsx)(n.p,{children:"to this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"COMPLEXITY_LIMIT=32 # complexity limit number\n"})}),"\n",(0,i.jsx)(n.h4,{id:"more-documentation",children:"More documentation"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://async-graphql.github.io/async-graphql/en/depth_and_complexity.html",children:"https://async-graphql.github.io/async-graphql/en/depth_and_complexity.html"})})]})}function l(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8032:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var r=t(2374);const i={},d=r.createContext(i);function o(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);